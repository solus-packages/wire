name       : wire
version    : 2.17.2813
release    : 4
source     :
    - https://github.com/wireapp/wire-desktop/archive/release/2.17.2813.tar.gz : 66e532a8b64231f0b7f11cce0dad389e56eff25cc4481976bcc466525d0aa8f6
license    : GPL-3.0
component  : network.im
summary    : A privacy focused instant messaging app
networking : true
description: |
    Official Client for the instant messaging service wire.com, which provides a Swiss based privacy focused service with end to end encryption.
builddeps  :
    - alsa-lib
    - gconf
    - libgtk-2
    - libxcomposite
    - libxcursor
    - libxi
    - libxrandr
    - libxscrnsaver
    - libxtst
    - git
    - nodejs
setup      : |
    %patch -p1 < $pkgfiles/0001-Wire-enable-asar-for-linux.patch
    npm config set unsafe-perm=true
    npm install
build      : |
    ./node_modules/grunt/bin/grunt --arch=x64 --target=dir linux-other
install    : |
    install -Dm644 $pkgfiles/wire.desktop $installdir/usr/share/applications/wire.desktop
    install -Dm644 $workdir/resources/icons/256x256.png $installdir/usr/share/icons/hicolor/256x256/apps/wire.png
    install -Dm644 $workdir/resources/icons/32x32.png $installdir/usr/share/icons/hicolor/32x32/apps/wire.png

    install -dm755 $installdir/usr/share/wire/
    cp -r $workdir/wrap/dist/linux-unpacked/* $installdir/usr/share/wire/

    install -dm755 $installdir/usr/bin
    ln -sv /usr/share/wire/wire-desktop $installdir/usr/bin/wire
